<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>School Committees</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ===== RESET ===== */
* { box-sizing: border-box; margin: 0; padding: 0; }

/* ===== LAYOUT ===== */
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}

.app {
  display: flex;
  min-height: 100vh;
}

/* ===== SIDEBAR ===== */
.sidebar {
  width: 240px;
  background: #1e3a5f;
  color: #fff;
  padding: 15px;
}

.sidebar h2 {
  font-size: 18px;
  margin-bottom: 15px;
  text-align: center;
}

.sidebar button {
  width: 100%;
  padding: 10px;
  margin-bottom: 8px;
  background: #2c5282;
  border: none;
  color: #fff;
  cursor: pointer;
  border-radius: 4px;
  text-align: left;
}

.sidebar button:hover,
.sidebar button.active {
  background: #f6ad55;
  color: #000;
}

/* ===== MAIN ===== */
.main {
  flex: 1;
  padding: 15px;
}

.header {
  font-size: 20px;
  margin-bottom: 10px;
}

.search {
  width: 100%;
  padding: 10px;
  margin-bottom: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

/* ===== TABLE ===== */
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: left;
}

th {
  background: #2c5282;
  color: #fff;
}

/* ===== CARDS (MOBILE) ===== */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 12px;
}

.card {
  background: #fff;
  padding: 12px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.card strong {
  display: inline-block;
  width: 120px;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .app {
    flex-direction: column;
  }
  .sidebar {
    width: 100%;
    display: flex;
    overflow-x: auto;
  }
  .sidebar button {
    flex: 1;
    margin-right: 5px;
    text-align: center;
  }
}
</style>
</head>

<body>

<div class="app">
  <!-- SIDEBAR -->
  <div class="sidebar">
    <h2>School Panels</h2>
    <button onclick="loadSheet('Society', this)">Society</button>
    <button onclick="loadSheet('SMC', this)">SMC</button>
    <button onclick="loadSheet('PTA (EC)', this)">PTA (EC)</button>
    <button onclick="loadSheet('PTA (GB)', this)">PTA (GB)</button>
    <button onclick="loadSheet('SLFRC', this)">SLFRC</button>
    <button onclick="loadSheet('Staff', this)">Staff</button>
  </div>

  <!-- MAIN -->
  <div class="main">
    <div class="header" id="title">Society</div>
    <input id="search" class="search" placeholder="üîç Search..." oninput="render()">
    <div id="output"></div>
  </div>
</div>

<script>
/* ===== APPS SCRIPT URL ===== */
const API =
"https://script.google.com/macros/s/AKfycbxOFSRqTTQ_BpkhWIJmNLKpU3DfdS13tXGYfcxhaVuMVwOTqNjqS8mvMuikCwz-0ffk/exec";

let rawData = [];

/* ===== LOAD SHEET ===== */
function loadSheet(name, btn) {

  document.getElementById("title").innerText = name;

  document.querySelectorAll(".sidebar button")
    .forEach(b => b.classList.remove("active"));
  if (btn) btn.classList.add("active");

  document.getElementById("output").innerHTML = "Loading...";

  fetch(`${API}?sheet=${encodeURIComponent(name)}`)
    .then(r => r.json())
    .then(data => {
      rawData = data;
      render();
    })
    .catch(err => {
      document.getElementById("output").innerHTML =
        "<p>‚ùå Failed to load data</p>";
      console.error(err);
    });
}

/* ===== RENDER ===== */
function render() {
  const q = document.getElementById("search").value.toLowerCase();
  const box = document.getElementById("output");

  const data = rawData.filter(r =>
    Object.values(r).join(" ").toLowerCase().includes(q)
  );

  if (!data.length) {
    box.innerHTML = "<p>No data found</p>";
    return;
  }

  /* Decide layout */
  if (window.innerWidth < 700) {
    renderCards(data);
  } else {
    renderTable(data);
  }
}

/* ===== TABLE VIEW ===== */
function renderTable(data) {
  let html = "<table><tr>";
  Object.keys(data[0]).forEach(h => html += `<th>${h}</th>`);
  html += "</tr>";

  data.forEach(r => {
    html += "<tr>";
    Object.values(r).forEach(v => html += `<td>${v}</td>`);
    html += "</tr>";
  });

  html += "</table>";
  output.innerHTML = html;
}

/* ===== CARD VIEW ===== */
function renderCards(data) {
  let html = "<div class='cards'>";
  data.forEach(r => {
    html += "<div class='card'>";
    Object.entries(r).forEach(([k,v]) => {
      html += `<div><strong>${k}:</strong> ${v}</div>`;
    });
    html += "</div>";
  });
  html += "</div>";
  output.innerHTML = html;
}

/* ===== INITIAL LOAD ===== */
loadSheet("Society");
</script>

</body>
</html>
