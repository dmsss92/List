<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>School Committees</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="School committees, staff and governing bodies">

<!-- ===== SCHEMA.ORG ===== -->
<script type="application/ld+json" id="schema">
{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "DAV Public School, Delhi",
  "url": "https://davschool.github.io"
}
</script>

<style>
/* ===== RESET ===== */
* { box-sizing: border-box; margin: 0; padding: 0; }

/* ===== BASE ===== */
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  color: #222;
}

/* ===== LAYOUT ===== */
.app {
  display: flex;
  min-height: 100vh;
}

/* ===== SIDEBAR ===== */
.sidebar {
  width: 240px;
  background: #1e3a5f;
  color: #fff;
  padding: 15px;
  position: sticky;
  top: 0;
  height: 100vh;
}

.sidebar img {
  width: 80px;
  display: block;
  margin: 0 auto 10px;
}

.sidebar h2 {
  text-align: center;
  margin-bottom: 15px;
  font-size: 18px;
}

.sidebar a {
  display: block;
  padding: 10px;
  margin-bottom: 8px;
  background: #2c5282;
  color: #fff;
  text-decoration: none;
  border-radius: 4px;
}

.sidebar a:hover,
.sidebar a.active {
  background: #f6ad55;
  color: #000;
}

/* ===== MAIN ===== */
.main {
  flex: 1;
  padding: 15px;
}

/* ===== BREADCRUMB ===== */
.breadcrumb {
  font-size: 14px;
  margin-bottom: 8px;
}

.breadcrumb a {
  color: #2c5282;
  text-decoration: none;
}

.breadcrumb span {
  margin: 0 6px;
}

/* ===== HEADER ===== */
.page-title {
  font-size: 20px;
  margin-bottom: 6px;
}

.meta {
  font-size: 13px;
  color: #666;
  margin-bottom: 10px;
}

/* ===== SEARCH ===== */
.search {
  width: 100%;
  padding: 10px;
  margin-bottom: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

/* ===== LOADER ===== */
.loader {
  text-align: center;
  padding: 20px;
}

/* ===== TABLE ===== */
table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
}

th {
  background: #2c5282;
  color: #fff;
}

/* ===== CARDS ===== */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 12px;
}

.card {
  background: #fff;
  padding: 12px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,.1);
}

.card strong {
  display: inline-block;
  width: 120px;
}

/* ===== FOOTER ===== */
footer {
  margin-top: 20px;
  padding: 12px;
  background: #1e3a5f;
  color: #fff;
  text-align: center;
  font-size: 14px;
}

/* ===== MOBILE ===== */
@media (max-width: 768px) {
  .app { flex-direction: column; }

  .sidebar {
    width: 100%;
    height: auto;
    display: flex;
    overflow-x: auto;
    position: relative;
  }

  .sidebar img { display: none; }

  .sidebar a {
    flex: 1;
    margin-right: 6px;
    text-align: center;
    white-space: nowrap;
  }
}
</style>
</head>

<body>

<div class="app">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <img src="logo.png" alt="School Logo">
    <h2>School Panels</h2>
    <a href="#society" class="nav">Society</a>
    <a href="#smc" class="nav">SMC</a>
    <a href="#pta-ec" class="nav">PTA (EC)</a>
    <a href="#pta-gb" class="nav">PTA (GB)</a>
    <a href="#slfrc" class="nav">SLFRC</a>
    <a href="#staff" class="nav">Staff</a>
  </div>

  <!-- MAIN -->
  <div class="main">
    <nav class="breadcrumb" id="breadcrumb"></nav>
    <div class="page-title" id="title"></div>
    <div class="meta" id="updated"></div>
    <input class="search" id="search" placeholder="ðŸ” Search..." oninput="render()">
    <div id="output"></div>

    <footer>
      Â© 2025 DAV Public School | All Rights Reserved
    </footer>
  </div>

</div>

<script>
const API =
"https://script.google.com/macros/s/AKfycbxOFSRqTTQ_BpkhWIJmNLKpU3DfdS13tXGYfcxhaVuMVwOTqNjqS8mvMuikCwz-0ffk/exec";

const ROUTES = {
  "society": "Society",
  "smc": "SMC",
  "pta-ec": "PTA (EC)",
  "pta-gb": "PTA (GB)",
  "slfrc": "SLFRC",
  "staff": "Staff"
};

let rawData = [];
let currentSheet = "";

/* ROUTING */
function handleRoute() {
  const hash = location.hash.replace("#", "") || "society";
  currentSheet = ROUTES[hash] || "Society";

  document.title = currentSheet + " | School Committees";
  document.getElementById("title").innerText = currentSheet + " (2025â€“26)";

  document.querySelectorAll(".nav")
    .forEach(a => a.classList.remove("active"));
  const active = document.querySelector(`a[href="#${hash}"]`);
  if (active) active.classList.add("active");

  document.getElementById("breadcrumb").innerHTML =
    `<a href="#">Home</a><span>â€º</span><span>${currentSheet}</span>`;

  loadSheet();
}

window.addEventListener("hashchange", handleRoute);

/* LOAD DATA WITH CACHE */
function loadSheet() {
  const cacheKey = "sheet_" + currentSheet;
  const cached = localStorage.getItem(cacheKey);

  document.getElementById("output").innerHTML =
    "<div class='loader'>Loadingâ€¦</div>";

  if (cached) {
    rawData = JSON.parse(cached);
    render();
  }

  fetch(`${API}?sheet=${encodeURIComponent(currentSheet)}`)
    .then(r => r.json())
    .then(d => {
      rawData = d;
      localStorage.setItem(cacheKey, JSON.stringify(d));
      document.getElementById("updated").innerText =
        "Last updated: " + new Date().toLocaleDateString();
      render();
    });
}

/* RENDER */
function render() {
  const q = document.getElementById("search").value.toLowerCase();
  const data = rawData.filter(r =>
    Object.values(r).join(" ").toLowerCase().includes(q)
  );

  if (!data.length) {
    output.innerHTML = "<p>No data available</p>";
    return;
  }

  if (window.innerWidth < 700 || currentSheet !== "Staff") {
    renderCards(data);
  } else {
    renderTable(data);
  }
}

function renderTable(data) {
  let html = "<table><tr>";
  Object.keys(data[0]).forEach(h => html += `<th scope="col">${h}</th>`);
  html += "</tr>";

  data.forEach(r => {
    html += "<tr>";
    Object.values(r).forEach(v => html += `<td>${v}</td>`);
    html += "</tr>";
  });

  html += "</table>";
  output.innerHTML = html;
}

function renderCards(data) {
  let html = "<div class='cards'>";
  data.forEach(r => {
    html += "<div class='card'>";
    Object.entries(r).forEach(([k,v]) => {
      html += `<div><strong>${k}:</strong> ${v}</div>`;
    });
    html += "</div>";
  });
  html += "</div>";
  output.innerHTML = html;
}

/* INIT */
handleRoute();
</script>

</body>
</html>

